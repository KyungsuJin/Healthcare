<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cafe24.kyungsu93.group.service.GroupInviteMapper">
	<insert id="inviteMemberApproval" 
			parameterType="com.cafe24.kyungsu93.group.service.GroupInvite">
	INSERT INTO group_invite_approval_result(
	group_invite_no, member_no, group_name, personal_information_approval, group_invite_approval_date
	)
	VALUES (
	#{groupInviteNo}, #{memberNo}, #{groupName},#{personalInformationApproval}, NOW()
	)
	</insert>
	<select id="groupInviteNo" resultType="Integer">
		SELECT
		max(CAST(substring(group_invite_no,14) AS DECIMAL))
		FROM group_invite
	</select>
	<insert id="inviteMember" 
			parameterType="com.cafe24.kyungsu93.group.service.GroupInvite">
	INSERT INTO group_invite(
	group_invite_no, group_no, member_no, group_invite_approval, group_invite_message, group_invite_date
	)
	VALUES (
	#{groupInviteNo}, #{groupNo}, #{memberNo}, #{groupInviteApproval}, #{groupInviteMessage}, NOW()
	)
	</insert>	
	<select  id="groupMemberList"
			parameterType="String" 
			resultType="com.cafe24.kyungsu93.group.service.GroupInvite">
		SELECT
			group_name as groupName,
			member_name as memberName,
			member_id as memberId,
			group_no as groupNo,
			group_Info as groupInfo,
			group_kind_Name as groupKindName
		FROM group_table a
		INNER JOIN group_kind b
		ON a.group_kind_no = b.group_kind_no
		ORDER BY group_invite_date DESC
		LIMIT #{beginRow},#{pagePerRow}
	</select>
	<select id="groupInviteMemberName" 
			parameterType="String" 
			resultType="com.cafe24.kyungsu93.group.service.GroupInvite">
		SELECT
			member_name as memberName,
			member_no as memberNo,
			member_agree as memberAgree
		FROM member
		WHERE member_id = #{memberId}	
	</select>
		<select id="personalAgreeMember" 
			parameterType="String" 
			resultType="com.cafe24.kyungsu93.group.service.GroupInvite">
		SELECT
			member_agree as memberAgree
		FROM member
		WHERE member_name = #{memberName}	
	</select>
	<select id="groupInviteMemberId" 
			parameterType="String" 
			resultType="Integer">
		SELECT
			count(*)
		FROM member
		WHERE member_id = #{memberId}	
	</select>
	<select id="totalCountInvite" 
			resultType="Integer">
		SELECT
			count(*)
		FROM group_invite
	</select>
	<select id="inviteGroupList" 
			parameterType="Integer" 
			resultType="com.cafe24.kyungsu93.group.service.GroupInvite">
	 	SELECT
			a.group_no as groupNo,
			a.group_invite_date as groupInviteDate,
			a.group_invite_message as groupInviteMessage,
			b.group_name as groupName,
			b.group_Info as groupInfo,			
			c.group_kind_name as groupKindName
		FROM group_invite a
		INNER JOIN group_table b
		ON a.group_no = b.group_no		
		INNER JOIN group_kind c
		ON b.group_kind_no = c.group_kind_no		
		ORDER BY group_invite_date DESC
		LIMIT #{beginRow},#{pagePerRow}
	</select>
	<select id="groupInviteList" 
			parameterType="Integer" 
			resultType="com.cafe24.kyungsu93.group.service.GroupInvite">
	 	SELECT
			b.group_name as groupName,
			a.group_no as groupNo,
			a.group_invite_approval as groupInviteApproval,
			a.group_invite_date as groupInviteDate,
			c.member_name as memberName,
			c.member_id as memberId
		FROM group_invite a
		INNER JOIN group_table b
		ON a.group_no = b.group_no
		INNER JOIN member c
		ON a.member_no = c.member_no		
		ORDER BY group_invite_date DESC
		LIMIT #{beginRow},#{pagePerRow}
	</select>
</mapper>